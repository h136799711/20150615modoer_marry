define("modules/search-result2",["avalon"],function(c,b,d){c("avalon");var e='<div class="result_wrap" ms-visible="toggle">'+"<ul>"+'<li ms-class-1="{{type}}-item" ms-class-2="active:$index ===idx" ms-repeat="resultList" ms-attr-data-id="el.hotel_id" ms-text="el.hotel_name" ms-click="confimItem($index, el.hotel_name, el.hotel_id)"></li>'+"</ul>"+"</div>";var a={attrs:{id:"",url:"",itemIndex:0,count:0},postData:{name:"",id:""},init:function(g){this.attrs.id=g.id;this.attrs.url=g.url;this.postData.name=g.vm_attr[1].value;this.postData.id=g.vm_attr[2].value;var k={},j;for(var h=0,f=g.vm_attr.length;h<f;h++){j=g.vm_attr[h];k[j.name]=j.value}this.initDom();this.initResultVm(k)},initDom:function(){var f=this;$("#"+f.attrs.id).attr("ms-controller","search_list").append(e)},initResultVm:function(h){var f=this;h.resultList=[];h.toggle=false;h.idx=0;h.$result_size=0;h.$config=false;h.confimItem=function(j,i,k){g.idx=j;f.configResult(g,i,k)};var g=avalon.define(h);h=null;avalon.scan(document.getElementById(f.attrs.id),g);g.$watch("name",function(i,l){if(g.$config){return}var k=l,j=f.attrs;if($.trim(k)!=""){$.getJSON(j.url+k,function(m){if(m.length>0){g.toggle=true;g.$result_size=m.length;g.resultList=m}})}});$("#"+f.attrs.id).find("input").on("keyup",function(j){g.$config=false;if(g.$result_size>0){if(j.which==38){f.tabItem(g,-1)}if(j.which==40){f.tabItem(g,1)}}if(j.which==13){var i=g.resultList[g.idx];f.configResult(g,i.hotel_name,i.hotel_id)}}).on("blur",function(i){setTimeout(function(){if(g.resultList.size()>0){if(g.$config){if(g.resultList[g.idx].hotel_name===g.name){f.savePostData(g,g.name,g.id)}else{f.savePostData(g,g.name)}}else{for(var k=0,j=g.resultList.size();k<j;k++){if(g.resultList[k].name===g.name){f.savePostData(g,g.name,g.id)}else{f.savePostData(g,g.name)}}}}else{f.savePostData(g,g.name)}g.toggle=false},300)})},savePostData:function(g,f,h){this.postData.name=g.name;if(h){this.postData.id=Number(h)}else{this.postData.id=""}},configResult:function(g,f,h){g.id=h;g.$config=true;g.name=f;g.toggle=false},tabItem:function(g,f){this.attrs.itemIndex+=f;g.idx=Math.abs(parseInt(this.attrs.itemIndex%g.$result_size,10))}};d.exports={render:function(f){a.init(f)},getData:function(){return a}}});