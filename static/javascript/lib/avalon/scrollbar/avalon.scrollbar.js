define("lib/avalon/scrollbar/avalon.scrollbar",["avalon","lib/avalon/draggable/avalon.draggable"],function(c,e,b){c("lib/avalon/draggable/avalon.draggable");var i='<div ms-repeat-pos="_position" class="oni-scrollbar oni-helper-reset oni-helper-clearfix oni-widget" ms-visible="!disabled" ms-class-100="oni-scrollbar-{{pos}}" ms-class-101="oni-scrollbar-{{size}} oni-scrollbar-{{pos}}-{{size}}" ms-class-102="oni-state-disabled:disabled" ms-mouseenter="_show($event, \'always\', $index)" ms-visible="toggle">'+'<div ms-if="showBarHeader" class="oni-scrollbar-arrow oni-scrollbar-arrow-up" ms-click="_arrClick($event, \'up\', pos, $index)" ms-mousedown="_arrDown($event,\'up\', pos, $index)" ms-class-100="oni-state-disabled:disabled" ms-mouseup="_arrDown($event,\'up\', pos, $index,\'release\')"ms-hover="oni-state-hover oni-scrollbar-arrow-hover"><b class="oni-scrollbar-trangle  oni-scrollbar-trangle-up"></b></div>'+'<div class="oni-scrollbar-draggerpar" ms-click="_barClick($event, pos, $index)">'+'<div class="oni-scrollbar-dragger" ms-attr-data-draggable-axis="pos == \'left\' || pos == \'right\' ? \'y\' : \'x\'" ms-click="_stopPropagation($event)" ms-class-100="oni-state-disabled:disabled" ms-mouseover="_show($event,\'always\',$index)" ms-mousedown="_draggerDown($event, true)" ms-mouseup="_draggerDown($event, false)" ms-mouseout="_draggerDown($event, false)" ms-hover="oni-state-hover" ms-html="draggerHTML"></div>'+"</div>"+'<div ms-if="showBarHeader" class="oni-scrollbar-arrow oni-scrollbar-arrow-down" ms-click="_arrClick($event, \'down\', pos, $index)" ms-mousedown="_arrDown($event,\'down\', pos, $index)" ms-mouseup="_arrDown($event,\'down\', pos, $index,\'release\')" ms-class-100="oni-state-disabled:disabled" ms-hover="oni-state-hover"><b class="oni-scrollbar-trangle oni-scrollbar-trangle-down"></b></div>'+"</div>";function a(l,m){var m=m||document.body;if(m.getElementsByClassName){return m.getElementsByClassName(l)}else{var n=m.getElementsByTagName("*"),k=[];avalon.each(n,function(o,p){var q=avalon(p);if(q.hasClass(l)){k.push(p)}});return k}}function h(k){return Math.round(parseFloat(k))||0}var d,g=[],j=[];var f=avalon.ui.scrollbar=function(m,n,l){var k=n.scrollbarOptions;k.template=k.getTemplate(i,k);var o=avalon.define(n.scrollbarId,function(s){avalon.mix(s,k);s.widgetElement=m;s.draggerHeight=s.draggerWidth="";s.inFocuse=false;s._position=[];s.viewElement=m;s.dragging=false;var q,r=[],p;s.$init=function(x){if(q){return}q=true;o.widgetElement.style.position="relative";o.viewElement=o.widgetElement==document.body?document.getElementsByTagName("html")[0]:o.widgetElement;o.viewElement.style.overflow=o.viewElement.style.overflowX=o.viewElement.style.overflowY="hidden";if(o.widgetElement==document.body){o.widgetElement.style.overflow=o.widgetElement.style.overflowX=o.widgetElement.style.overflowY="hidden"}o._position=o.position.split(",");var A=avalon.parseHTML(k.template);o.widgetElement.appendChild(A);if(x){x()}else{avalon.log("avalon请尽快升到1.3.7+");avalon.scan(m,[o].concat(l));if(typeof k.onInit==="function"){k.onInit.call(m,o,k,l)}}var w=o.widgetElement.childNodes;avalon.each(w,function(B,C){var D=avalon(C);if(D.hasClass("oni-scrollbar")||D.hasClass("ui-scrollbar")){r.push(D)}else{if(D.hasClass("oni-scrollbar-scroller")||D.hasClass("ui-scrollbar-scroller")){p=D}}});if(o.position.match(/left|right/g)||o.isScroll_hs){var z=[],v=[];avalon.each(o._position,function(B,C){if(C.match(/left|right/g)){z.push([B,C])}else{v.push([B,C])}});function t(E,B,D,C){avalon.each(B,function(F,G){if(!r[F].data("oni-scrollbar-needed")){return}o._computer(C||function(H){return o._clickComputer(H,E)},G[0],G[1],function(H){if(!H){D.preventDefault()}},"breakOutCallbackCannotIgnore")})}function u(B){if(o.disabled){return}if(o.inFocuse){if(o.isScroll_hs){if(o.wheelBtn){o.wheelBtn=false;t(B.wheelDelta>0?"up":"down",v,B)}}else{t(B.wheelDelta>0?"up":"down",z,B)}}}function y(C){if(o.disabled){return}var B=C.keyCode;if(B>32&&B<41&o.inFocuse){if(B in {37:1,39:1,38:1,40:1}){t(B in {37:1,38:1}?"up":"down",B in {38:1,40:1}?z:v,C)}else{var D=B in {33:1,36:1}?"up":"down";t(D,z,C,function(E){var G=p[0].scrollTop;if(B in {33:1,36:1}){if(G){C.preventDefault()}}else{if(G<E.scrollerH-E.viewH){C.preventDefault()}}if(B in {36:1,35:1}){return{x:0,y:B==36?0:E.draggerparHeight-E.draggerHeight+100}}else{var F=(E.draggerparHeight-E.draggerHeight)*E.viewH/(E.scrollerH-E.viewH);return o._clickComputer(E,D,h(F)||1)}})}}}if(o.isScroll_hs){o.inFocuse=true;g.push(u);j.push(y)}if(o.widgetElement==document.body){o.inFocuse=true;g.push(u);j.push(y)}else{avalon.bind(m,"mouseenter",function(B){o.inFocuse=true;g.push(u);j.push(y)});avalon.bind(m,"mouseleave",function(D){o.inFocuse=false;for(var C=0,B=g.length;C<B;C++){if(g[C]===u){g.splice(C,1);j.splice(C,1);break}}})}if(!d){d=true;avalon.bind(document,"mousewheel",function(C){var B=g[g.length-1];B&&B(C)});avalon.bind(document,"keydown",function(C){var B=j[j.length-1];B&&B(C)})}}avalon.bind(m,"mouseenter",function(){avalon.each(r,function(B,C){o._show("e",false,C)})});avalon.bind(m,"mouseleave",function(){o._hide()});o.update("init")};s.$draggableOpts={beforeStart:function(){o.dragging=true},drag:function(v,t){var u=avalon(t.element);o._computer(function(x){var w={x:h(u.css("left"))>>0,y:h(u.css("top"))>>0};if(w.x==x.draggerparWidth-x.draggerWidth){w.x+=100}if(w.y==x.draggerparHeight-x.draggerHeight){w.y+=100}return w},u.attr("oni-scrollbar-index"),u.attr("oni-scrollbar-pos"),false,false,true)},handle:function(u,t){return !o.disabled&&this},containment:"parent"};s.$draggableOpts.stop=function(u,t){o.$draggableOpts.drag(u,t);o.dragging=false;avalon(t.element).removeClass("oni-state-active")};s.$remove=function(){avalon.each(r,function(t,u){u[0]&&u[0].parentNode&&u[0].parentNode.removeChild(u[0])})};s._onScroll=function(){if(o.show!="scrolling"){return}avalon.each(r,function(t,u){o._show("e",false,u)})};s._show=function(w,t,u){if(o.show!="scrolling"){return}w.stopPropagation&&w.stopPropagation();var v=u.css?u:r[u];if(v){clearTimeout(v.data("oni-scrollbar-hidetimer"));v.css("visibility","visible");v.css("opacity",1);if(!t){v.data("oni-scrollbar-hidetimer",setTimeout(function(){v.css("opacity",0)},1000))}}};s._hide=function(u,t){if(o.show!="scrolling"){return}if(t&&r[t]){r[t].css("opacity",0)}else{avalon.each(r,function(v,w){w.css("opacity",0)})}};s.getBars=function(){return r};s.getScroller=function(){return p};s.update=function(F,J,H){if(o.disabled){return}var M=avalon(o.viewElement),A,K,I=o.widgetElement===document.body?o.viewElement.clientHeight:h(M.css("height")),v=h(M.css("width")),E=o.viewHeightGetter(M),L=o.viewWidthGetter(M),z=o.position,u,B={},H=H==void 0?o.scrollTop:H,J=J==void 0?o.scrollLeft:J;if(o.viewElement!=o.widgetElement){z.match(/right|left/g)&&avalon(o.widgetElement).css("height",I)}var G=p.width()-p.innerWidth(),C=p.height()-p.innerHeight();p.css("height",E+C);p.css("width",L+G);A=p[0].scrollWidth;K=p[0].scrollHeight;u={"top":z.match(/top/g)&&A>L,"right":z.match(/right/g)&&K>E,"bottom":z.match(/bottom/g)&&A>L,"left":z.match(/left/g)&&K>E};if(r.length>1){var t=["top","right","bottom","left"];for(var D=0;D<4;D++){B[t[D]]=[(u[D?t[D-1]:t[3]]&&1)>>0,(u[D<3?t[D+1]:t[0]]&&1)>>0];if(D>1){B[t[D]]=B[t[D]].reverse()}}}E=p.innerHeight();L=p.innerWidth();avalon.each(o._position,function(X,ac){var Z=r[X],P=ac.match(/left|right/),y;if(Z){y=avalon(a("oni-scrollbar-dragger",Z.element)[0])}if(F&&y){y.attr("ms-draggable","$,$draggableOpts");y.attr("oni-scrollbar-pos",ac);y.attr("oni-scrollbar-index",X);avalon.scan(y[0],o)}if(!u[ac]){if(Z){Z.css("opacity",0);Z.css("visibility","hidden");Z.data("oni-scrollbar-needed",false)}return}else{if(Z){Z.data("oni-scrollbar-needed",true);Z.css("visibility","visible");if(o.show=="scrolling"||o.show=="never"){Z.css("opacity",0)}else{Z.css("opacity",1)}}}if(Z){var ad=h(Z.css("height")),V=h(Z.css("width")),x=ad,aa=V,Q=avalon(a("oni-scrollbar-draggerpar",Z[0])[0]),O=o.showBarHeader?2:0;var S=[];if(r.length>1){var T=[],w=B[ac];if(P){T=[["top",w[0]*aa],["height",(I-aa*(w[0]+w[1]))]];S=[["top",(O/2)*aa],["height",(I-aa*(w[0]+w[1]+O))]]}else{T=[["left",w[0]*x],["width",(v-x*(w[0]+w[1]))]];S=[["left",(O/2)*x],["width",(v-x*(O+w[0]+w[1]))]]}avalon.each(T,function(ae,af){Z.css.apply(Z,af)});x=Z.height();aa=Z.width()}else{if(P){S=[["top",aa],["height",(I-aa*2)]]}else{if(o.showBarHeader){S=[["left",x],["width",(v-x*2)]]}else{S=[["left",0],["width",(v)]]}}}var ab;if(P){ab=o.show=="always"?aa:0;p.css("width",L+G-ab)}else{ab=o.show=="always"?x:0;p.css("height",E+C-ab)}avalon.each(S,function(ae,af){Q.css.apply(Q,af)});ad=x-O*aa;V=aa-O*x;var W;if(P){var Y=H,N=h(E*ad/K);N=o.limitRateV*aa>N&&o.limitRateV*aa||N;Y=Y<0?0:Y;Y=Y>K-E?K-E:Y;Y=h((ad-N)*Y/(K-E));Y=Math.min(ad-N,Y);W=[["width","100%"],["height",N],["top",Y]];H=H>0?(H>K-E+ab?K-E+ab:H):0}else{var R=J,U=h(L*V/A);U=o.limitRateH*x>U&&o.limitRateH*x||U;R=R<0?0:R;R=R>A-L?A-L:R;R=h((V-U)*R/(A-L));R=Math.min(V-U,R);W=[["height","100%"],["width",U],["left",R]];J=J>0?(J>A-L+ab?A-L+ab:J):0}avalon.each(W,function(ae,af){y.css.apply(y,af)});if(F){if(P){o._scrollTo(void 0,H)}else{o._scrollTo(J,void 0)}}if(o.showBarHeader){if(H==0&&P||!P&&J==0){avalon(a("oni-scrollbar-arrow-up",Z[0])[0]).addClass("oni-state-disabled")}else{avalon(a("oni-scrollbar-arrow-up",Z[0])[0]).removeClass("oni-state-disabled")}if(H>=Q.innerHeight()-y.innerHeight()&&P||!P&&J>=Q.innerWidth()-y.innerWidth()){!o.breakOutCallback&&avalon(a("oni-scrollbar-arrow-down",Z[0])[0]).addClass("oni-state-disabled")}else{avalon(a("oni-scrollbar-arrow-down",Z[0])[0]).removeClass("oni-state-disabled")}}}})};s._arrClick=function(v,w,t,u){if(o.disabled){return}o._computer(function(x){return o._clickComputer(x,w)},u,t)};s._clickComputer=function(z,A,w){var w=w||z.step||40,u=h(z.dragger.css("left"))>>0,v=h(z.dragger.css("top"))>>0,t=A=="down"?u+w:u-w,B=A=="down"?v+w:v-w;return{x:t,y:B}};s._arrDown=function(v,A,t,u,w){if(o.disabled){return}var z=this,y=avalon(z);clearInterval(y.data("mousedownTimer"));clearTimeout(y.data("setTimer"));var x=r[u];if(w||y.hasClass("oni-state-disabled")){return y.removeClass("oni-state-active")}y.data("setTimer",setTimeout(function(){y.addClass("oni-state-active");y.data("mousedownTimer",setInterval(function(){return o._computer(function(B){return o._clickComputer(B,A)},u,t,function(B){if(!B){return}clearInterval(y.data("mousedownTimer"));clearTimeout(y.data("setTimer"))})},120))},10))};s._barClick=function(w,t,u){if(o.disabled){return}var v=avalon(this);if(v.hasClass("oni-scrollbar-dragger")){return}o._computer(function(x){return{x:Math.ceil(w.pageX-x.offset.left-x.draggerWidth/2),y:Math.ceil(w.pageY-x.offset.top-x.draggerHeight/2)}},u,t)};s._computer=function(C,w,y,D,t,x){if(o.disabled){return}var z=r[w];if(z&&z.data("oni-scrollbar-needed")){var v={},B=y.match(/left|right/g);v.dragger=avalon(a("oni-scrollbar-dragger",z[0])[0]);v.draggerWidth=h(v.dragger.css("width"));v.draggerHeight=h(v.dragger.css("height"));v.draggerpar=avalon(v.dragger[0].parentNode);v.draggerparWidth=h(v.draggerpar.css("width"));v.draggerparHeight=h(v.draggerpar.css("height"));v.offset=v.draggerpar.offset();v.up=avalon(a("oni-scrollbar-arrow-up",z[0])[0]);v.down=avalon(a("oni-scrollbar-arrow-down",z[0])[0]);v.viewer=avalon(o.viewElement);v.viewH=p.innerHeight();v.viewW=p.innerWidth();v.scrollerH=p[0].scrollHeight;v.scrollerW=p[0].scrollWidth;v.step=B?40*(v.draggerparHeight-v.draggerHeight)/(v.scrollerH-v.viewH):o.oneStep*(v.draggerparWidth-v.draggerWidth)/(v.scrollerW-v.viewW);v.step=h(v.step)||1;var E=C(v),u;E.x=h(E.x);E.y=h(E.y);if(B){if(E.y<0){E.y=0;v.up.addClass("oni-state-disabled");u=["v","up"]}else{v.up.removeClass("oni-state-disabled")}if(E.y>v.draggerparHeight-v.draggerHeight){E.y=v.draggerparHeight-v.draggerHeight;u=["v","down"];v.down.addClass("oni-state-disabled")}else{v.down.removeClass("oni-state-disabled")}var A=h((v.scrollerH-v.viewH)*E.y/(v.draggerparHeight-v.draggerHeight))-o.scrollTop;v.dragger.css("top",E.y);o._scrollTo(void 0,h((v.scrollerH-v.viewH)*E.y/(v.draggerparHeight-v.draggerHeight)))}else{if(E.x<0){E.x=0;u=["h","up"];v.up.addClass("oni-state-disabled")}else{v.up.removeClass("oni-state-disabled")}if(E.x>v.draggerparWidth-v.draggerWidth){E.x=v.draggerparWidth-v.draggerWidth;u=["h","down"];!o.breakOutCallback&&v.down.addClass("oni-state-disabled")}else{v.down.removeClass("oni-state-disabled")}v.dragger.css("left",E.x);o._scrollTo(h((v.scrollerW-v.viewW)*E.x/(v.draggerparWidth-v.draggerWidth)),void 0,x)}}(!o.breakOutCallback||t)&&D&&D(u);o.breakOutCallback&&o.breakOutCallback(u,o,v)};s._scrollTo=function(t,v,u){if(v!=void 0){p[0].scrollTop=v;o.scrollTop=p[0].scrollTop}if(t!=void 0){if(o.isScroll_hs&&!u){$(p[0]).animate({scrollLeft:t},200,function(){o.wheelBtn=true;o.scrollLeft=p[0].scrollLeft})}else{p[0].scrollLeft=t;o.scrollLeft=p[0].scrollLeft}}};s.scrollTo=function(t,u){o.update(!"ifInit",t,u);s._scrollTo(t,u)};s._initWheel=function(u,t){if(t=="enter"){o.inFocuse=true}else{o.inFocuse=false}};s._draggerDown=function(v,t){if(o.disabled){return}var u=avalon(this);if(t){u.addClass("oni-state-active")}else{u.removeClass("oni-state-active")}};s._stopPropagation=function(t){t.stopPropagation()}});o.$watch("scrollLeft",function(q,p){o._onScroll();o.onScroll&&o.onScroll(q,p,"h",o)});o.$watch("scrollTop",function(q,p){o._onScroll();o.onScroll&&o.onScroll(q,p,"v",o)});return o};f.defaults={disabled:false,toggle:true,position:"right",limitRateV:1.5,limitRateH:1.5,scrollTop:0,scrollLeft:0,show:"always",showBarHeader:true,draggerHTML:"",breakOutCallback:false,onInit:avalon.noop,viewHeightGetter:function(k){return k.innerHeight()},viewWidthGetter:function(k){return k.innerWidth()},getTemplate:function(k,l){return k},onScroll:function(m,k,n,l){},size:"normal",$author:"skipper@123",isScroll_hs:false,wheelBtn:true,oneStep:40,focus:false}});